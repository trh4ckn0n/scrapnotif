name: Notifications Telegram

on:
  watch:
    types: [started, created]  # "started" pour suivre, "created" pour donner une √©toile
  fork:
    types: [created]   # Lorsqu'un utilisateur fork votre repo
  workflow_dispatch:
  
jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: R√©cup√©rer les √©v√©nements GitHub
        run: |
          echo "√âv√©nement GitHub d√©clench√© par : ${{ github.actor }}"
          echo "Type d'√©v√©nement : ${{ github.event_name }}"
          echo "Action : ${{ github.event.action }}"

      - name: Envoi de la notification Telegram
        env:
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          CHAT_ID: ${{ secrets.CHAT_ID }}
        run: |
          # Message √† envoyer sur Telegram
          MESSAGE="üîî Nouvelle activit√© GitHub :
          
          - Action : ${{ github.event_name }}
          - Type d'action : ${{ github.event.action }}
          - Utilisateur : ${{ github.actor }}  # Affiche le nom d'utilisateur de la personne
          - R√©f√©rentiel : ${{ github.repository }}

          üëâ Allez voir votre profil GitHub pour plus de d√©tails : https://github.com/${{ github.actor }}"

          # Envoi du message via Telegram API
          curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage" \
               -d chat_id="${CHAT_ID}" \
               -d text="${MESSAGE}"
